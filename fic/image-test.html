<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <script src="../js/jquery.min.js"></script>
        <script src="imgLib.js"></script>
    </head>
    <body>
        <h1>Image Tests</h1>
        <h2>Matching</h2>
        <div>
            <canvas id="match-1"></canvas>
            <canvas id="match-2"></canvas>
            <canvas id="match-result"></canvas>
            <pre id="match-log"></pre>
            <script>
                var log = $('#match-log');
                var mc1 = $('#match-1').get(0);
                var mc2 = $('#match-2').get(0);
                var mrc = $('#match-result').get(0);
                
                var img1 = new Image(128, 128);
                for (var x=0; x < 128; x++) {
                    for (var y=0; y < 128; y++) {
                        img1.channels[0][y*128+x] = x;
                    }
                }
                //                img1.fillRect(0, 0, 128, 128, 0, 63);
                img1.paint(mc1);
                
                var img2 = new Image(128, 128);
                img2.fillRect(0, 0, 128, 128, 0, 180);
                for (var x=0; x < 128; x++) {
                    for (var y=0; y < 128; y++) {
                        img2.channels[0][y*128+x] = 255 - 2*x;
                    }
                }
                img2.paint(mc2);
                
                var mr = img1.match(img2);
                log.append('offset = ' + mr[1]);
                log.append('\nscale = ' + mr[2]);
                log.append('\nerror = ' + mr[0]);
                
                var img3 = img2.clone();
                img3.adjust(mr[1], mr[2]);
                img3.paint(mrc);
                
                log.append("\nmeasured error = " + img1.difference(img3));
            </script>
        </div>
        <h2>YUV Conversion</h2>
        <div>
            <img id="testpic-src" onload="testYUV()" src="testpic-mini.jpg" />
            <canvas id="testpic-dst"></canvas>
            <script>
                function testYUV() {
                    var img = imageToImage($('#testpic-src').get(0));
                    var img2 = parseImage(img.serialize());
                    img2.paint($('#testpic-dst').get(0));   
                }
            </script>
        </div>
    </body>
</html>